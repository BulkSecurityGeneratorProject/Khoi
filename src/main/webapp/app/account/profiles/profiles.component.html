<div class="modal-header profiles">
    <span>My Account</span>
</div>
<div class="modal-body profiles">
    <div class="profile">
        <div class="title">
            <span jhiTranslate="profiles.title">Profile</span>
            <a *ngIf="collapse.profile" href="javascript:void(0);"
               (click)="collapse.password = true;collapse.profile = !collapse.profile"
               [attr.aria-expanded]="!collapse.profile">
                <i class="fa fa-pencil" aria-hidden="true"></i>
            </a>
        </div>
        <div class="">
            <div class="alert alert-success" *ngIf="successProfile" jhiTranslate="settings.messages.success">
                <strong>Settings saved!</strong>
            </div>
        </div>
        <div class="col-md-12" id="collapseProfile" [ngbCollapse]="collapse.profile">
            <form name="form" role="form" (ngSubmit)="save()" #settingsForm="ngForm" *ngIf="settingsAccount"
                  novalidate>
                <div class="form-group row">
                    <div class="col-md-2">
                        <label class="form-control-label" jhiTranslate="settings.form.firstname">First
                            Name</label>
                    </div>
                    <div class="col-md-10">
                        <input type="text" class="form-control" id="firstName" name="firstName"
                               placeholder="{{'settings.form.firstname.placeholder' | translate}}"
                               [(ngModel)]="settingsAccount.firstName" minlength=1 maxlength=50
                               #firstNameInput="ngModel" required>
                        <div *ngIf="firstNameInput.dirty && firstNameInput.invalid">
                            <small class="form-text text-danger"
                                   *ngIf="firstNameInput.errors.required"
                                   jhiTranslate="settings.messages.validate.firstname.required">
                                Your first name is required.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="firstNameInput.errors.minlength"
                                   jhiTranslate="settings.messages.validate.firstname.minlength">
                                Your first name is required to be at least 1 character.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="firstNameInput.errors.maxlength"
                                   jhiTranslate="settings.messages.validate.firstname.maxlength">
                                Your first name cannot be longer than 50 characters.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-md-2">
                        <label class="form-control-label" for="lastName" jhiTranslate="settings.form.lastname">Last
                            Name</label>
                    </div>
                    <div class="col-md-10">
                        <input type="text" class="form-control" id="lastName" name="lastName"
                               placeholder="{{'settings.form.lastname.placeholder' | translate}}"
                               [(ngModel)]="settingsAccount.lastName" minlength=1 maxlength=50
                               #lastNameInput="ngModel" required>
                        <div *ngIf="lastNameInput.dirty && lastNameInput.invalid">
                            <small class="form-text text-danger"
                                   *ngIf="lastNameInput.errors.required"
                                   jhiTranslate="settings.messages.validate.lastname.required">
                                Your last name is required.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="lastNameInput.errors.minlength"
                                   jhiTranslate="settings.messages.validate.lastname.minlength">
                                Your last name is required to be at least 1 character.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="lastNameInput.errors.maxlength"
                                   jhiTranslate="settings.messages.validate.lastname.maxlength">
                                Your last name cannot be longer than 50 characters.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-md-2">
                        <label class="form-control-label" for="email"
                               jhiTranslate="global.form.email">Email</label>
                    </div>
                    <div class="col-md-10">
                        <input type="email" class="form-control" id="email" name="email"
                               placeholder="{{'global.form.email.placeholder' | translate}}"
                               [(ngModel)]="settingsAccount.email" minlength="5" maxlength="100"
                               #emailInput="ngModel" required>
                        <div *ngIf="emailInput.dirty && emailInput.invalid">
                            <small class="form-text text-danger"
                                   *ngIf="emailInput.errors.required"
                                   jhiTranslate="global.messages.validate.email.required">
                                Your email is required.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="emailInput.errors.email"
                                   jhiTranslate="global.messages.validate.email.invalid">
                                Your email is invalid.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="emailInput.errors.minlength"
                                   jhiTranslate="global.messages.validate.email.minlength">
                                Your email is required to be at least 5 characters.
                            </small>
                            <small class="form-text text-danger"
                                   *ngIf="emailInput.errors.maxlength"
                                   jhiTranslate="global.messages.validate.email.maxlength">
                                Your email cannot be longer than 100 characters.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="form-group row" *ngIf="languages && languages.length > 0">
                    <div class="col-md-2">
                        <label for="langKey" jhiTranslate="settings.form.language">Language</label>
                    </div>
                    <div class="col-md-10">
                        <select class="form-control" id="langKey" name="langKey"
                                [(ngModel)]="settingsAccount.langKey">
                            <option *ngFor="let language of languages" [value]="language">{{language |
                                findLanguageFromKey}}
                            </option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 text-center">
                        <button type="submit" [disabled]="settingsForm.form.invalid" class="btn btn-primary"
                                jhiTranslate="entity.action.save">Save
                        </button>
                    </div>
                    <div class="col-md-6 text-center">
                        <button *ngIf="!collapse.profile" type="button" class="btn btn-danger"
                                (click)="collapse.profile = !collapse.profile;errorProfile=null;successProfile=null"
                                [attr.aria-expanded]="!collapse.profile" aria-controls="collapseProfile"
                                jhiTranslate="entity.action.cancel">
                            Cancel
                        </button>
                    </div>
                </div>
            </form>
        </div>
        <div class="view-profile" [ngbCollapse]="!collapse.profile">
            <div>
                <label jhiTranslate="settings.form.firstname">First Name</label>
                <span>{{account.firstName}}</span>
            </div>
            <div>
                <label jhiTranslate="settings.form.lastname">Last Name</label>
                <span>{{account.lastName}}</span>
            </div>
            <div>
                <label jhiTranslate="global.form.email">Email</label>
                <span>{{account.email}}</span>
            </div>
            <div>
                <label jhiTranslate="settings.form.language">Language</label>
                <span>{{account.langKey|findLanguageFromKey}}</span>
            </div>
        </div>
    </div>
    <div class="password">
        <div class="title">
            <span jhiTranslate="global.form.password">Password</span>
            <a *ngIf="collapse.password" href="javascript:void(0);"
               (click)="collapse.profile = true;collapse.password = !collapse.password"
               [attr.aria-expanded]="!collapse.password" aria-controls="collapsePassword">
                <i class="fa fa-pencil" aria-hidden="true"></i>
            </a>
        </div>
        <div class="col-md-12">
            <div class="alert alert-success" *ngIf="successPassword" jhiTranslate="password.messages.success">
                <strong>Password changed!</strong>
            </div>
            <div class="alert alert-danger" *ngIf="errorPassword" jhiTranslate="password.messages.error">
                <strong>An error has occurred!</strong> The password could not be changed.
            </div>
            <div class="alert alert-danger" *ngIf="errorOldPassword"
                 jhiTranslate="password.messages.oldPasswordError">
                <strong>Old password not correct!</strong> The password could not be changed.
            </div>
            <div class="alert alert-danger" *ngIf="doNotMatch" jhiTranslate="global.messages.error.dontmatch">
                The password and its confirmation do not match!
            </div>
        </div>
        <div class="col-md-12" id="collapsePassword" [ngbCollapse]="collapse.password">
            <form name="form" role="form" (ngSubmit)="changePassword()" #passwordForm="ngForm">
                <div class="form-group">
                    <input type="password" class="form-control" id="oldPassword" name="oldPassword"
                           #oldPasswordInput="ngModel"
                           placeholder="{{'global.form.oldpassword.placeholder' | translate}}"
                           [(ngModel)]="oldPassword" minlength=4 maxlength=50 required>
                    <div *ngIf="oldPasswordInput.dirty && oldPasswordInput.invalid">
                        <small class="form-text text-danger"
                               *ngIf="oldPasswordInput.errors.required"
                               jhiTranslate="global.messages.validate.oldpassword.required">
                            Your old password is required.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="oldPasswordInput.errors.minlength"
                               jhiTranslate="global.messages.validate.oldpassword.minlength">
                            Your old password is required to be at least 4 characters.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="oldPasswordInput.errors.maxlength"
                               jhiTranslate="global.messages.validate.oldpassword.maxlength">
                            Your old password cannot be longer than 50 characters.
                        </small>
                    </div>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" id="password" name="password"
                           #passwordInput="ngModel"
                           placeholder="{{'global.form.newpassword.placeholder' | translate}}"
                           [(ngModel)]="password" minlength=4 maxlength=50 required>
                    <div *ngIf="passwordInput.dirty && passwordInput.invalid">
                        <small class="form-text text-danger"
                               *ngIf="passwordInput.errors.required"
                               jhiTranslate="global.messages.validate.newpassword.required">
                            Your password is required.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="passwordInput.errors.minlength"
                               jhiTranslate="global.messages.validate.newpassword.minlength">
                            Your password is required to be at least 4 characters.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="passwordInput.errors.maxlength"
                               jhiTranslate="global.messages.validate.newpassword.maxlength">
                            Your password cannot be longer than 50 characters.
                        </small>
                    </div>
                    <jhi-password-strength-bar [passwordToCheck]="password"></jhi-password-strength-bar>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
                           #confirmPasswordInput="ngModel"
                           placeholder="{{'global.form.confirmpassword.placeholder' | translate}}"
                           [(ngModel)]="confirmPassword" minlength=4 maxlength=50 required>
                    <div *ngIf="confirmPasswordInput.dirty && confirmPasswordInput.invalid">
                        <small class="form-text text-danger"
                               *ngIf="confirmPasswordInput.errors.required"
                               jhiTranslate="global.messages.validate.confirmpassword.required">
                            Your confirmation password is required.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="confirmPasswordInput.errors.minlength"
                               jhiTranslate="global.messages.validate.confirmpassword.minlength">
                            Your confirmation password is required to be at least 4 characters.
                        </small>
                        <small class="form-text text-danger"
                               *ngIf="confirmPasswordInput.errors.maxlength"
                               jhiTranslate="global.messages.validate.confirmpassword.maxlength">
                            Your confirmation password cannot be longer than 50 characters.
                        </small>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 text-center">
                        <button type="submit" [disabled]="passwordForm.form.invalid" class="btn btn-primary"
                                jhiTranslate="password.form.button">Save
                        </button>
                    </div>
                    <div class="col-md-6 text-center">
                        <button *ngIf="!collapse.password" type="button" class="btn btn-danger"
                                (click)="collapse.password = !collapse.password;successPassword=null;errorPassword=null;errorOldPassword=null"
                                [attr.aria-expanded]="!collapse.password" aria-controls="collapsePassword"
                                jhiTranslate="entity.action.cancel">
                            Cancel
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="preferences">
        <div class="title">
            <span jhiTranslate="profiles.form.preferences">Preferences</span>
        </div>
        <div class="col-md-12">
            <div class="alert alert-success" *ngIf="success" jhiTranslate="settings.messages.success">
                <strong>Settings saved!</strong>
            </div>
        </div>
        <div class="row">
            <div *ngFor="let publisher of publisherCrawled; let i = index" class="col-md-4">
                <a (click)="publisher.check=!publisher.check;">
                    <i [ngClass]="publisher.check?'fa fa-check-square-o':'fa fa-square-o'"
                        aria-hidden="true"></i>
                    <span>{{publisher.name}}</span>
                </a>
            </div>
        </div>
    </div>
    <div class="notification">
        <div class="title">
            <span jhiTranslate="profiles.notification">Notification</span>
        </div>
        <a (click)="notification=!notification">
            <i [ngClass]="notification?'fa fa-check-square-o':'fa fa-square-o'"
               aria-hidden="true"></i>
            <div>
                <span jhiTranslate="profiles.notification.description">Please notify me through
                        email when a new grant is published that is in line with my preferences.</span>
            </div>
        </a>
    </div>
</div>
